# Simple Makefile
#
#  Author: Jesper Dangaard Brouer <brouer@redhat.com>
#
SRCS =  ipv6_example01.c udp_example02.c udp_echo.c udp_client_echo.c \
	raw_packet_send.c

OBJECTS = common_socket.o common.o
HEADERS = ${OBJECTS:.o=.h}

TARGETS = ${SRCS:.c=}
LIBS_PCAP=-lpcap

all: $(TARGETS)

help:
	@echo Possible targets: $(TARGETS)

# Create dependency to OBJECTS
$(TARGETS): $(OBJECTS)

# OBJECTS
%.o: %.c $(HEADERS) global.h Makefile
	$(CC) $(CFLAGS) -c  $< -o $@

# TARGETS
.c: $<
	gcc -o $@ $< $(OBJECTS)

pcap_timeread: pcap_timeread.c
	gcc -o $@ $(LIBS_PCAP) $<

pcap_read: pcap_read.c
	gcc -o $@ $(LIBS_PCAP) $<

clean:
	@echo "Removing autogenerated files."
	@find . -type f \( -name '*~' -o -name '*.o' -o -name 'core' \) \
	        -print | xargs rm -f
	@echo "Removing binary targets"
	rm -f $(TARGETS)
